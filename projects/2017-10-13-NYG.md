---
layout: post
title: NYG
author: hyungsun
category: [swift, my-project]
timelineText: Information sharing app for Noryangjin exam takers
startDate: 2017.6.13
endDate: 2017.9.21
image: assets/images/nyg_1.png
asset_media: assets/images/nyg_1.png
asset_caption: 
asset_credit: 
---

> 아이폰 앱을 하나 개발해 보시지 않을래요? 그렇게 안 어렵던데.  

어느 날 평소 친하게 지내던 지인 분이 내게 제안을 해왔고, 난 순진무구하게 Apple world 에 입문하게 되었다. 아이폰 앱은 mac 에서 밖에 개발할 수 없다는 것도 사실 이 때 처음 알았다.

### Environment
- swift 4  
- Xcode 10
- Carthage 0.26.2
- NaverMap API v2.1.3
- 아래는 Cartfile 내용이다.  

```C
github "devxoul/Toaster"
github "zhangao0086/DKImagePickerController"
github "Alamofire/Alamofire" ~> 4.5.1
github "Alamofire/AlamofireImage" ~> 3.1
github "Orderella/PopupDialog" ~> 0.5
github "optonaut/ActiveLabel.swift"
github "WenchaoD/FSCalendar"
```

### When
2017.6.13 ~ 2017.9.21  

### Preview
![]({{ site.url }}/assets/images/nyg_1.png)

### Description
노량진에서 공부하는 고시생들의 수는 줄기는 커녕 점점 늘어만 간다. 누구나 철밥통을 끌어안고 살고 싶은 욕망은 있는 법이니까. 그래서 이 고시생들을 타깃으로 한 식당, 학원, 놀거리 들이 참 많은데, 워낙 조밀조밀하게 밀집해 있다보니 naver로 검색해도 검색결과가 만족스럽지 못한 게 대부분이다. 이 앱을 내게 만들어 달라고 부탁한 사람은 아마 그런 아이디어로부터 시작하지 않았나 짐작을 해봤다.  

참고로 마켓에는 앱 설명이 이렇게 올라와 있다.
> 노량진 수험생을 위한 필수 어플리케이션.  
> 스터디룸 및 독서실 예약에서부터 학원 및 강의 후기, 시험 정보 등 수험생활에 대한 모든 것을 공유한다.

### 어려웠던 점
`Swift`를 접한 것도 처음, 앱을 배포한 것도 처음. 그러나 정작 어려웠던 점은 따로 있었다.

#### 잠깐만, 힘들게 멕북을 샀는데 13 만원을 더 내라고?
![]({{ site.url }}/assets/images/nyg_3.png)  

애플 개발자로써 개발을 하려면 애플에다가 한국 돈으로 1년에 약 13만원을 내야 한다. 애플 개발은 처음이었기 때문에 돈을 내야 개발할 수 있다는 사실은 신선한 충격이었다. 더군다나 13만원을 내고 나서도 신경써야 할 것이 한 두가지가 아닌 것이 13만원을 내면 개발용 인증서와 배포용 인증서를 발급할 권한을 주기만 할 뿐 그 외엔 알아서 하라는 식이기  때문이다.  

한번은 나도 모르는 사이 배포용 인증서의 개인키가 덮어씌여지는 바람에 정말 골치를 앓았다. 배포용 인증서의 개인키를 잃어버리면 에뮬레이터 환경에서는 컴파일도 실행도 잘되는 데 실제 디바이스에서는 컴파일 단계에서부터 `code sign error`가 뜬다. 하지만 이 코드 사이닝 에러는 이 에러를 유발시킬 수 있는 경우의 수가 너무나 많은 데다 키체인 접근에서 관리하고 있는 개인키를 잃어버리는 것도 흔한 일은 아니기 때문에 이 에러가 인증서와 관련된 문제라는 것도 디버깅을 시작한 지 한참 뒤에야 알게되었다.  

문제를 해결하려면 인증기관(CA)에 인증서를 재요청해야 하는데 아무리 인증서 요청을 해도 mac은 내게 "아이디와 암호가 맞지 않습니다."라는 에러메시지를 돌려줄 뿐이었다. 인증서를 요청할 때 아래와 같은 창이 뜨는데, 암호를 입력하라는 란은 없다.  

![]({{ site.url }}/assets/images/nyg_2.png)  

인증서 요청을 할 때 암호를 입력하는 란도 없는데 암호가 맞지 않는다니? 무언가 잘못됐다고 생각했다.
심지어 에러를 구글링 해도 소득 없는 해결책을 해보고 되돌리기만 반복될 뿐 상황이 해결될 기미는 전혀 보이지 않았다. 

정신적인 고통 속에 아이디와 암호가 맞지 않는다는 경고창을 마주하기를 수 십번, 번개같이 **"에러 창을 띄우는 게 너무 빠른거 아냐?"** 라는 생각이 머리를 스쳤다. 마치 인증서 요청하는 패킷이 손실되어 에러가 났지만, 에러 처리를 잘못해서 저런 오류메시지를 띄운 것처럼 보였다.  

당시에 카페 공용 와이파이를 잡아서 작업을 하고 있었기 때문에 와아파이가 보안에 취약해서 안보내는 게 아닐까 하고 핫스팟을 켜서 인증서 요청을 하니, 결국 인증서를 받아 개인키를 복구하는 데 성공했다. 내 생각이 맞았는지 틀렸는지는 지금도 잘 모르겠지만, 만약 그 생각을 떠올리지 못했다면 지금 이 포스팅을 올리고 있지도 못했을 것이다. 



#### Optional
사실 가장 처음 마주친 어려움은 `Swift` 그 자체였다. 다른 건 그닥 어렵지 않았는데 `Optional`이 자꾸만 헷갈렸다. 뭐 그냥 런타임 시에 발생할 법한 타입 캐스팅 오류들을 컴파일할 때 미리 잡아줄게~ 하는 녀석이구나 싶었지만, `binding`부터 `Wrap`, `Unwrap`, `Chaning` 까지 `best-practice` 는 무엇이며 `!`는 왜 남발하면 안되는가와 같은 언어의 철학을 이해하는 것이 힘들었다. 

어느 정도 코드를 작성하고 디버깅을 해보고 나니 그제서야 이해가 가기 시작했다.  

참고로 `!`를 남발하면 안되는 이유는 `Optional`의 사용 목적을 무색하게 만들어 버리기 때문이다. 강제로 unwrap을 하게 되면 컴파일 시에는 에러가 나지 않던 게 런타임에서 에러가 발생할 수 있다. 

#### 헬게이트를 오픈 하시겠습니까?
어느 날씨 좋은 날, 신나게 코딩중이었는데 갑자기 Xcode가 친근하게 물어본다. 

> 새로 나온 버전이 있습니다. 업데이트 하시겠습니까?  

mac을 처음 써보던 나는 아무 생각없이 '예'를 꾹 눌렀지만, 그 것이 크나큰 재앙을 가져올 줄은 꿈에도 몰랐다. 그 업데이트는 무려 `Swift4`가 새로 출시되면서 기존 Xcode를 8 버젼에서 9 버젼으로 업데이트 하고 그에 발맞춰 지원하는 iOS 도 10에서 11로 바꿔버리는 무시무시한 업데이트였다. 업데이트 하고 나니 `Swift3`버젼 대에서 컴파일 되었던 모든 라이브러리는 컴파일 에러가 나고 잘되던 `Carthage`가 갑자기 말썽을 일으키기 시작했다. `Carthage`가 말썽을 일으킨다는 이슈는 다른 곳에서는 확인하지 못했고, 스스로 이걸 해결하지 못한 까닭에 원인은 지금까지 불명이다.  

며칠 간의 고민과 삽질 끝에 [stackoverflow](https://stackoverflow.com/questions/46362724/carthage-build-failed-after-updating-swift-to-version-4-0){:target="_blank"}에 공손히 질문을 올려봤지만 제시해주는 해결책은 전부 제가 해봤던 것들이었다. 당시에 짐작을 했던 원인은 OpenMP 병렬프로그래밍 환경을 멕에 세팅하면서 무언가 건드린 게 `clang`과 충돌이 났지 않을까 였는데, `Carthage`, `Xcode`, `clang` 등 관련 있어보이는 것들은 전부 `reinstall` 해봤는데도 문제가 해결될 조짐은 보이지 않았다. 임시로 `Xcode 8.3.3`을 다운받아 `Xcode-select`로 스위칭 해가면서 코딩을 했지만, `Carthage update`가 실패해가지고는 정말 아무것도 할 수 없었습니다. `pod`으로 태세전환을 하지 않는 이상 `library`를 쓰지 말라는 사형 선고였으니까.

그래서 하는 수 없이 눈물을 머금고 멕북을 포맷하기로 결정했다. 다행히 포맷하고 모두 재설치를 하니 문제는 잘 해결이 되었지만, 원인을 지금까지도 밝히지 못한 것이 참 아쉽다.

#### 어서와, 앱 배포는 처음이지? 
애플에서는 앱을 심사한다...는 것을 심사에서 떨어지고 나서야 피부로 체감했다. 뭔가 품질 안 좋은 코드를 제출하는 것 같은 기분이 들어 부끄러웠고, 테스트를 다 해보지 않고 성급하게 앱을 제출했다는 사실이 부끄러웠다. iphone 으로만 테스트를 하고 ipad에서 테스트를 해보지 않은 까닭에 UI가 ipad에서 심하게 일그러진다는 사실을 깨닫지 못했다. 애플 심사하시는 분(혹은 봇)들이 친절하게 스크린 샷까지 첨부해줬었던 기억이 난다. 아래는 당시 받았던 feedback 메일내용 일부다.  

![]({{ site.url }}/assets/images/nyg_4.png)  

다행히 한 번 거절당한 이후로 그 뒤 심사에서는 거절당하는 일이 없었다.  
개발자 메일 계정이 제 개인 메일 계정과 달랐기 때문에 저런 메일이 왔던 줄도 모르고 앱 올려놓은 게 왜 안뜨는지 모르겠다고 푸념을 늘어놓았던 기억이 있다. 만약 애플 개발자가 되시려고 하신다면 꼭 [apple developer](ttps://developer.apple.com/){:target="_blank"}에서 본인 메일 계정을 등록하시기 바란다. 


#### 생각보다 맘에 쏙 드는 라이브러리가 없다
코딩을 하면서 라이브러리를 가져다 쓰다보면 '아 시간만 허락한다면 이 라이브러리 고쳐다 쓰고 싶은데...' 라는 생각을 하는 경우가 많았다. 


#### 개발자가 아닌 사람들과의 커뮤니케이션
프로젝트를 진행하다보면 '지금 내가 하는 작업이 디자인이야 코딩이야?' 라는 의문을 품게 되는 순간들이 있다. 이런 순간들은 대개 코딩을 알아야 작업하기 편한 경우가 대부분이라 주로 개발자가 맡아 작업하게 된다. 
특히나 `UX/UI` 디자인이 여기에 해당된다.  

나는 `UX/UI`를 따로 공부를 하거나 하진 않았지만, 앱의 기획을 보고 이 앱을 사용했을 때 얼마나 편한지, 혹은 불편한지 상상 정도는 할 수 있었다. 그런 내 판단으로는 앱이 상당히 불편해 보이길래, 초반에 좀 이상하다는 생각을 했다. 하지만 아이폰 개발이 처음이니 불만을 품지 않고 기획자나 디자이너가 주는 대로 코딩을 열심히 했는데, 나중에 가서야 결국 내 생각이 옳았다는 걸 깨달았다. 하지만 누가 옳았든지 간에 부수고 다시 고치는 작업은 오롯이 내 몫이었지만 말이다.  

이 과정에서 나는 이상하다는 생각이 들면 그때 그때 의논을 해야한다는 것을 배웠다. 대부분 경험 많은 상대방이 옳지만, 가끔 정도는 내 생각이 옳을 수도 있으니까. 상대방이 옳다면 내가 배울 점이 생기는 거고 내 생각이 옳다면 그만큼 시간을 아낄 수 있다. 
